# Generated by Django 5.2.5 on 2025-08-31 17:28

import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('dataset', '0009_modelprediction_dictionary_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='annotation',
            options={'ordering': ['-created_at', '-id'], 'verbose_name': 'Adnotacja', 'verbose_name_plural': 'Adnotacje'},
        ),
        migrations.AlterModelOptions(
            name='datasetsample',
            options={'ordering': ['-created_at', '-id'], 'verbose_name': 'Próbka danych', 'verbose_name_plural': 'Próbki danych'},
        ),
        migrations.AlterModelOptions(
            name='labelfinal',
            options={'ordering': ['-created_at', 'kind_id'], 'verbose_name': 'Etykieta finalna', 'verbose_name_plural': 'Etykiety finalne'},
        ),
        migrations.AlterModelOptions(
            name='modelprediction',
            options={'ordering': ['-created_at', '-id'], 'verbose_name': 'Predykcja modelu', 'verbose_name_plural': 'Predykcje modeli'},
        ),
        migrations.RemoveConstraint(
            model_name='datasetsample',
            name='uniq_sample_by_hash_and_preprocess',
        ),
        migrations.RemoveIndex(
            model_name='datasetsample',
            name='dataset_dat_preproc_fe4cb1_idx',
        ),
        migrations.RemoveField(
            model_name='datasetsample',
            name='char_end',
        ),
        migrations.RemoveField(
            model_name='datasetsample',
            name='char_start',
        ),
        migrations.RemoveField(
            model_name='datasetsample',
            name='email',
        ),
        migrations.AddField(
            model_name='datasetsample',
            name='source',
            field=models.CharField(db_index=True, default='generic', help_text="Identyfikator źródła pochodzenia treści (np. 'email', 'chat', 'webform', 'www', 'generic').", max_length=64, verbose_name='źródło'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='annotator',
            field=models.ForeignKey(help_text='Użytkownik, który wprowadził adnotację.', on_delete=django.db.models.deletion.PROTECT, related_name='annotations', to=settings.AUTH_USER_MODEL, verbose_name='adnotator'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='comment',
            field=models.TextField(blank=True, default='', help_text='Uwagi adnotatora do tej etykiety.', verbose_name='komentarz'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='confidence',
            field=models.FloatField(default=1.0, help_text='Deklarowana pewność adnotatora w skali 0–1.', verbose_name='pewność'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='created_at',
            field=models.DateTimeField(default=django.utils.timezone.now, help_text='Znacznik czasu dodania adnotacji.', verbose_name='utworzono'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='evidence_snippet',
            field=models.TextField(blank=True, default='', help_text='Fragment treści uzasadniający wybór.', verbose_name='snippet (dowód)'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='is_gold',
            field=models.BooleanField(default=False, help_text="Flaga oznaczająca adnotację jako 'złotą' (referencyjną).", verbose_name='gold'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='kind',
            field=models.ForeignKey(help_text="Rodzaj etykiety (np. 'emotion', 'style').", on_delete=django.db.models.deletion.PROTECT, related_name='+', to='dataset.dictionarykind', verbose_name='rodzaj'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='sample',
            field=models.ForeignKey(help_text='Próbka, którą adnotujemy.', on_delete=django.db.models.deletion.CASCADE, related_name='annotations', to='dataset.datasetsample', verbose_name='próbka'),
        ),
        migrations.AlterField(
            model_name='annotation',
            name='value',
            field=models.ForeignKey(help_text='Proponowana wartość słownikowa.', on_delete=django.db.models.deletion.PROTECT, related_name='annotations', to='dataset.dictionaryvalue', verbose_name='wartość'),
        ),
        migrations.AlterField(
            model_name='datasetsample',
            name='content',
            field=models.TextField(help_text='Znormalizowana treść próbki używana do trenowania i etykietowania.', verbose_name='treść (kanoniczna)'),
        ),
        migrations.AlterField(
            model_name='datasetsample',
            name='content_hash',
            field=models.CharField(db_index=True, editable=False, help_text='Skrót SHA-256 znormalizowanej treści; służy do deduplikacji i linkowania.', max_length=64, verbose_name='skrót treści (sha256)'),
        ),
        migrations.AlterField(
            model_name='datasetsample',
            name='created_at',
            field=models.DateTimeField(default=django.utils.timezone.now, help_text='Znacznik czasu utworzenia próbki.', verbose_name='utworzono'),
        ),
        migrations.AlterField(
            model_name='datasetsample',
            name='lang',
            field=models.CharField(blank=True, default='', help_text="Kod języka próbki (np. 'pl').", max_length=8, verbose_name='język'),
        ),
        migrations.AlterField(
            model_name='datasetsample',
            name='preprocess_version',
            field=models.CharField(db_index=True, default='v1', help_text='Wersja pipeline’u przygotowania tekstu (np. reguły czyszczenia).', max_length=16, verbose_name='wersja preprocessingu'),
        ),
        migrations.AlterField(
            model_name='labelfinal',
            name='comment',
            field=models.TextField(blank=True, default='', help_text='Uwagi użytkownika do etykiety finalnej.', verbose_name='komentarz'),
        ),
        migrations.AlterField(
            model_name='labelfinal',
            name='created_at',
            field=models.DateTimeField(default=django.utils.timezone.now, help_text='Znacznik czasu utworzenia/aktualizacji etykiety finalnej.', verbose_name='utworzono'),
        ),
        migrations.AlterField(
            model_name='labelfinal',
            name='evidence_snippet',
            field=models.TextField(blank=True, default='', help_text='Fragment treści uzasadniający wybór etykiety.', verbose_name='snippet (dowód)'),
        ),
        migrations.AlterField(
            model_name='labelfinal',
            name='kind',
            field=models.ForeignKey(help_text="Rodzaj etykiety (np. 'emotion', 'style').", on_delete=django.db.models.deletion.PROTECT, related_name='+', to='dataset.dictionarykind', verbose_name='rodzaj'),
        ),
        migrations.AlterField(
            model_name='labelfinal',
            name='sample',
            field=models.ForeignKey(help_text='Próbka danych, której dotyczy etykieta.', on_delete=django.db.models.deletion.CASCADE, related_name='labels_final', to='dataset.datasetsample', verbose_name='próbka'),
        ),
        migrations.AlterField(
            model_name='labelfinal',
            name='value',
            field=models.ForeignKey(help_text='Wybrana wartość słownikowa dla tego rodzaju.', on_delete=django.db.models.deletion.PROTECT, related_name='final_for_samples', to='dataset.dictionaryvalue', verbose_name='wartość'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='created_at',
            field=models.DateTimeField(default=django.utils.timezone.now, help_text='Znacznik czasu zapisu predykcji.', verbose_name='utworzono'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='dictionary',
            field=models.ForeignKey(blank=True, help_text='Konkretna wersja słownika, w ramach której wybrano wartość (opcjonalnie).', null=True, on_delete=django.db.models.deletion.PROTECT, to='dataset.dictionary', verbose_name='zestaw słownikowy'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='evidence_snippet',
            field=models.TextField(blank=True, default='', help_text='Fragment treści wskazany przez model jako uzasadnienie.', verbose_name='snippet (dowód)'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='kind',
            field=models.ForeignKey(help_text='Rodzaj etykiety, którego dotyczy predykcja.', on_delete=django.db.models.deletion.PROTECT, related_name='+', to='dataset.dictionarykind', verbose_name='rodzaj'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='model_name',
            field=models.CharField(help_text="Identyfikator/dostawca modelu (np. 'openai').", max_length=64, verbose_name='nazwa modelu'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='model_version',
            field=models.CharField(help_text="Wersja/model użyty do inferencji (np. 'gpt-4o-mini').", max_length=32, verbose_name='wersja modelu'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='proba',
            field=models.FloatField(default=0.0, help_text='Pewność modelu (0–1).', verbose_name='prawdopodobieństwo'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='sample',
            field=models.ForeignKey(help_text='Próbka, dla której zapisano predykcję.', on_delete=django.db.models.deletion.CASCADE, related_name='predictions', to='dataset.datasetsample', verbose_name='próbka'),
        ),
        migrations.AlterField(
            model_name='modelprediction',
            name='value',
            field=models.ForeignKey(help_text='Wartość przewidziana przez model.', on_delete=django.db.models.deletion.PROTECT, related_name='predictions', to='dataset.dictionaryvalue', verbose_name='wartość'),
        ),
        migrations.AddIndex(
            model_name='datasetsample',
            index=models.Index(fields=['source', 'preprocess_version', 'content_hash'], name='dataset_dat_source_9a4f56_idx'),
        ),
        migrations.AddIndex(
            model_name='datasetsample',
            index=models.Index(fields=['lang'], name='dataset_dat_lang_492415_idx'),
        ),
        migrations.AddConstraint(
            model_name='datasetsample',
            constraint=models.UniqueConstraint(fields=('content_hash', 'preprocess_version', 'source'), name='uniq_sample_by_hash_preprocess_source'),
        ),
    ]
