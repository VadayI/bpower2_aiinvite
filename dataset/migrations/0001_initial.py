# Generated by Django 5.2.5 on 2025-08-29 08:30

import django.db.models.deletion
import django.utils.timezone
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Dictionary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.SlugField(max_length=64, verbose_name='kod zestawu')),
                ('name', models.CharField(max_length=160, verbose_name='nazwa zestawu')),
                ('description', models.TextField(blank=True, default='', verbose_name='opis zestawu')),
                ('version', models.CharField(default='v1', max_length=32, verbose_name='wersja')),
                ('locale', models.CharField(default='pl', max_length=16, verbose_name='język/locale')),
                ('is_active', models.BooleanField(default=True, verbose_name='aktywny')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='utworzono')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='zaktualizowano')),
            ],
            options={
                'verbose_name': 'Zestaw etykiet',
                'verbose_name_plural': 'Zestawy etykiet',
                'ordering': ['-is_active', 'code', 'version', 'locale'],
                'indexes': [models.Index(fields=['code', 'version', 'locale'], name='dataset_dic_code_420f54_idx'), models.Index(fields=['is_active'], name='dataset_dic_is_acti_119ab6_idx')],
                'unique_together': {('code', 'version', 'locale')},
            },
        ),
        migrations.CreateModel(
            name='DictionaryKind',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.SlugField(max_length=64, unique=True, verbose_name='kod rodzaju')),
                ('name', models.CharField(max_length=160, verbose_name='nazwa rodzaju')),
                ('description', models.TextField(blank=True, default='', verbose_name='opis rodzaju')),
            ],
            options={
                'verbose_name': 'Rodzaj etykiety',
                'verbose_name_plural': 'Rodzaje etykiet',
                'ordering': ['name'],
                'indexes': [models.Index(fields=['code'], name='dataset_dic_code_2412fe_idx')],
            },
        ),
        migrations.CreateModel(
            name='DictionaryValue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.SlugField(max_length=64, verbose_name='kod wartości')),
                ('name', models.CharField(max_length=160, verbose_name='nazwa wartości')),
                ('description', models.TextField(blank=True, default='', verbose_name='opis wartości')),
                ('sort_order', models.IntegerField(default=0, verbose_name='kolejność')),
                ('is_active', models.BooleanField(default=True, verbose_name='aktywna')),
                ('dictionary', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='values', to='dataset.dictionary', verbose_name='zestaw')),
                ('kind', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='values', to='dataset.dictionarykind', verbose_name='rodzaj')),
            ],
            options={
                'verbose_name': 'Wartość etykiety',
                'verbose_name_plural': 'Wartości etykiet',
                'ordering': ['kind__name', 'sort_order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='Label',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('content', models.TextField(verbose_name='treść e-maila')),
                ('content_hash', models.CharField(db_index=True, editable=False, max_length=64, verbose_name='hash treści')),
                ('snippet', models.TextField(blank=True, default='', help_text='Wycinek treści e-maila, który najlepiej uzasadnia tę etykietę.', verbose_name='fragment treści')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='utworzono')),
                ('comment', models.TextField(blank=True, default='', verbose_name='uwagi')),
                ('kind', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='labels', to='dataset.dictionarykind', verbose_name='rodzaj etykiety')),
                ('value', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='labels', to='dataset.dictionaryvalue', verbose_name='wartość')),
            ],
            options={
                'verbose_name': 'Etykieta',
                'verbose_name_plural': 'Etykiety',
                'ordering': ['-created_at', 'kind__name'],
            },
        ),
        migrations.AddIndex(
            model_name='dictionaryvalue',
            index=models.Index(fields=['dictionary', 'kind'], name='dataset_dic_diction_b7782a_idx'),
        ),
        migrations.AddIndex(
            model_name='dictionaryvalue',
            index=models.Index(fields=['kind', 'sort_order'], name='dataset_dic_kind_id_c930c6_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='dictionaryvalue',
            unique_together={('dictionary', 'kind', 'code')},
        ),
        migrations.AddIndex(
            model_name='label',
            index=models.Index(fields=['kind'], name='dataset_lab_kind_id_566ffb_idx'),
        ),
        migrations.AddIndex(
            model_name='label',
            index=models.Index(fields=['value'], name='dataset_lab_value_i_a6ffd9_idx'),
        ),
        migrations.AddIndex(
            model_name='label',
            index=models.Index(fields=['content_hash', 'kind'], name='dataset_lab_content_17d675_idx'),
        ),
        migrations.AddConstraint(
            model_name='label',
            constraint=models.UniqueConstraint(fields=('content_hash', 'kind'), name='uniq_label_per_contenthash_and_kind'),
        ),
    ]
